<!DOCTYPE html>
<html>
<head>
  <title>FB Pay Business - Secure Payment</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="container">
  <h1>FB Pay Business</h1>
  <p>Secure Payment Portal</p>

  <form id="userForm">

    <input type="text" id="name" placeholder="Enter Customer Name" required><br>

    <input type="text" id="phone" placeholder="Enter Phone Number" required><br>

    <input type="email" id="email" placeholder="Enter Email Address" required><br>

    <input type="number" id="amount" placeholder="Enter Amount (â‚¹)" required><br>

    <button type="submit" class="btn">Proceed to Pay</button>
  </form>
</div>


<script src="https://checkout.razorpay.com/v1/checkout.js"></script>

<script>
document.getElementById("userForm").onsubmit = async function(e){
    e.preventDefault();

    const userData = {
        name: document.getElementById("name").value,
        phone: document.getElementById("phone").value,
        email: document.getElementById("email").value,
        amount: document.getElementById("amount").value
    };

    // create Razorpay order
    let order = await fetch("http://localhost:5000/create-order", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify(userData)
    });

    order = await order.json();

    var options = {
        "key": "YOUR_KEY_ID", 
        "amount": order.amount,
        "currency": "INR",
        "name": "FB Pay Business",
        "description": "Payment",
        "order_id": order.id,

        "handler": async function (response){

            // send payment + user data to backend
            await fetch("http://localhost:5000/payment-success", {
                method:"POST",
                headers:{"Content-Type":"application/json"},
                body:JSON.stringify({
                    payment: response,
                    user: userData
                })
            });

            alert("âœ… Payment Successful!\nðŸ“© Receipt sent to email & phone.");
        }
    };

    var rzp1 = new Razorpay(options);
    rzp1.open();
};
</script>

</body>
</html>
